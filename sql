SELECT SQL_CALC_FOUND_ROWS DISTINCT shop_products.ID, shop_products.USER_ID, shop_products.EXTERNAL_ID, shop_products.URL, shop_products.ACTIVE, shop_products.HIT, shop_products.HOT, shop_products.ACTION, shop_products.BRAND_ID, shop_products.CATEGORY_ID, shop_products.RELATED_PRODUCTS, shop_products.MAINIMAGE, shop_products.MAINMODIMAGE, shop_products.SMALLIMAGE, shop_products.SMALLMODIMAGE, shop_products.OLD_PRICE, shop_products.CREATED, shop_products.UPDATED, shop_products.VIEWS, shop_products.ADDED_TO_CART_COUNT, shop_products.ENABLE_COMMENTS, shop_products.TPL, shop_products_i18n.ID, shop_products_i18n.LOCALE, shop_products_i18n.NAME, shop_products_i18n.SHORT_DESCRIPTION, shop_products_i18n.FULL_DESCRIPTION, shop_products_i18n.META_TITLE, shop_products_i18n.META_DESCRIPTION, shop_products_i18n.META_KEYWORDS, IF(sum(shop_product_variants.stock) > 0, 1, 0) AS allstock FROM `shop_products` INNER JOIN `shop_product_categories` ON (shop_products.ID=shop_product_categories.PRODUCT_ID) INNER JOIN `shop_products_i18n` ON (shop_products.ID=shop_products_i18n.ID AND shop_products_i18n.LOCALE = 'ru') INNER JOIN `shop_product_variants` ON (shop_products.ID=shop_product_variants.PRODUCT_ID) LEFT JOIN `shop_brands` ON (shop_products.BRAND_ID=shop_brands.ID) WHERE shop_product_categories.CATEGORY_ID=144 AND shop_products.ACTIVE=1 AND (FLOOR(shop_product_variants.PRICE) >= 2 AND FLOOR(shop_product_variants.PRICE) <= 2) GROUP BY shop_products.ID ORDER BY allstock DESC,shop_products.HIT DESC,shop_products.CREATED DESC LIMIT 12