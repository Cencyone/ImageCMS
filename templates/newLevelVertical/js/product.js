var productPhotoCZoom=window.productPhotoCZoom!=undefined,productPhotoDrop=window.productPhotoDrop!=undefined;function tovarChangeVariant(a){a=a==undefined?body:a;a.find(genObj.parentBtnBuy).find(genObj.changeVariantProduct).on("change",function(){var f=parseInt($(this).attr("value")),b=$(this).closest(genObj.parentBtnBuy),l=b.find(genObj.prefV+f+" "+genObj.infoBut),m=l.attr("data-id"),d=l.attr("data-vname"),g=l.attr("data-number"),h=l.attr("data-price"),i=l.attr("data-addPrice"),c=l.attr("data-origPrice"),k=l.attr("data-largeImage"),e=l.attr("data-mainImage"),j=l.attr("data-maxcount");if(e.search(/nophoto/)==-1){$(genObj.photoProduct).add($(genObj.mainThumb)).attr("href",k);$(genObj.imgVP).attr({src:e,alt:d});$(".left-product .items-thumbs > li").removeClass("active").filter(":eq(0)").addClass("active")}if(c!=""){b.find(genObj.priceOrigVariant).html(c)}b.find(genObj.priceVariant).html(h);b.find(genObj.priceAddPrice).html(i);existsVnumber(g,b);existsVnames(d,b);condProduct(j,b,l);b.find(genObj.selVariant).hide();b.find(genObj.prefV+m).show();$(".mousetrap").remove();$(".cloud-zoom, .cloud-zoom-gallery").CloudZoom()})}function initDrop(a){$this=a;$this.data($.extend({frame:$this.closest(genObj.parentBtnBuy),mainPhoto:$this.attr("href"),title:$this.attr("title")},optionsPhoto));return true}function resizePhoto(a,j,f){var g=a.find(".drop-content-photo"),b=g.find("img"),i=a.is(":visible")?true:false,h=i?a.height():a.actual("height"),e=h>wnd.height()?wnd.height():h,d=0;g.css("height","");b.css({width:b.actual("width"),height:b.actual("height")});if(j!=undefined){j()}a.find(a.data("dropHeader")).add(a.find(a.data("dropFooter"))).each(function(){d+=i?$(this).outerHeight():$(this).actual("outerHeight")});g.css({height:e-d-(g.outerHeight()-g.height())});b.css({width:"",height:""});if(f!=undefined){f()}$.drop("center")(a)}function changePhoto(a,b,d){hrefOptions.curHref=d;var c=a[1];b.parent().addClass("p_r");b.after('<div class="preloader"></div>');$('<img src="'+d+'">').load(function(){c.find(".drop-content-photo").find("img").remove();b.nextAll(".preloader").remove();b.after($(this).css("visibility","visible").hide().fadeIn());var e=c.find(".content-carousel");$.drop("limitSize")(c);resizePhoto(c,function(){$.drop("center")(c)});e.find(".jcarousel-item").eq($.inArray(hrefOptions.curHref,hrefOptions.thumbs)).find("a").focus()})}function beforeShowHref(a,f,e,v,c){var d=arguments,h=hrefOptions.cycle,i=$.extend({},c,hrefOptions,a.closest(genObj.parentBtnBuy).find(genObj.infoBut).data()),j=$("#photo");j.html(_.template($("#framePhotoProduct").html(),i));var n=$(hrefOptions.next),l=$(hrefOptions.prev),o=f.find(".drop-content-photo"),w=o.find("img");hrefOptions.curHref=w.attr("src");var q=o.find(".helper");function b(x){if(!h){if(x==0){l.attr("disabled","disabled")}if(x==t-1){n.attr("disabled","disabled")}}}function g(x){k.removeClass("active");if(x.is(l)){n.removeAttr("disabled")}else{l.removeAttr("disabled")}u=($.inArray(hrefOptions.curHref,hrefOptions.thumbs));if(x.is(l)){if(h){if(u!=0){u=u-1}else{u=t-1}}else{if(u!=0){u=u-1}if(u==0){l.attr("disabled","disabled")}}}else{if(h){if(u!=t-1){u=u+1}else{u=0}}else{if(u!=t-1){u=u+1}if(u==t-1){n.attr("disabled","disabled")}}}m.eq(u).parent().addClass("active");changePhoto(d,q,hrefOptions.thumbs[u])}var r=f.find(".content-carousel");if($.existsN(r.find(".items-thumbs").children())){r.closest(".horizontal-carousel").show();var k=r.find(".items-thumbs > li").removeClass("active"),t=k.length,m=k.find("a");hrefOptions.thumbs=new Array();m.each(function(){hrefOptions.thumbs.push($(this).attr("href"))});var p=l.add(n).removeAttr("disabled").fadeIn(),u=($.inArray(w.attr("src"),hrefOptions.thumbs));k.eq(u).addClass("active");var s=k.parent();if($.existsN(s.parent(".jcarousel-clip"))){s.unwrap()}m.off("click").on("click",function(z){p.removeAttr("disabled");k.removeClass("active");$(this).parent().addClass("active");var x=$(this).attr("href"),y=($.inArray(x,hrefOptions.thumbs));z.preventDefault();changePhoto(d,q,x);b(y)});p.off("click").on("click",function(x){g($(this))});b(u)}else{r.closest(".horizontal-carousel").hide()}wnd.unbind("resize.photo").bind("resize.photo",function(){resizePhoto(f)})}function afterClosedPhoto(b,a){a.find(".addingphoto").remove()}function onComplete(d,c,a,e,b){c.find("[data-drop]").drop(optionsDrop);var f=c.find(".content-carousel");c.find(".drop-content-photo img").css("visibility","visible");resizePhoto(c,function(){f.parent().myCarousel($.extend({},carousel,{adding:{start:$.inArray(hrefOptions.curHref,hrefOptions.thumbs)},after:function(g){g.find("ul").css("visibility","visible")}}))})}var hrefOptions={next:"#photo .drop-content-photo .next",prev:"#photo .drop-content-photo .prev",gallery:"#photo .frame-fancy-gallery",cycle:false,footerContent:".frame-prices-buy",galleryContent:".items-thumbs"};var optionsPhoto={effectOn:"fadeIn",drop:"#photo",position:"absolute",before:"beforeShowHref",after:"onComplete",closed:"afterClosedPhoto"};function initPhoto(){if(productPhotoCZoom){function a(){$(genObj.photoProduct).find("img").each(function(){var c=$(this),b=Math.ceil((c.parent().outerHeight()-c.height())/2),d=Math.ceil((c.parent().outerWidth()-c.width())/2);$("#forCloudZomm").empty().append(".cloud-zoom-lens{margin:"+b+"px 0 0 "+d+"px;}.mousetrap{top:"+b+"px !important;left:"+d+"px !important;}")});$(".left-product").off("mouseover",".mousetrap").on("mouseover",".mousetrap",function(){var b=$(".cloud-zoom-lens");if(b.width()>$(genObj.photoProduct).width()){$(this).remove();b.remove();$("#xBlock").empty()}})}}if(productPhotoCZoom){$(".cloud-zoom, .cloud-zoom-gallery").CloudZoom();body.append('<style id="forCloudZomm"></style>');a();$(genObj.photoProduct).find("img").load(function(){a()})}$(".item-product .items-thumbs > li > a").on("click.thumb",function(d){d.preventDefault();var c=$(this),b=c.attr("href");c.parent().siblings().removeClass("active").end().addClass("active");$(genObj.photoProduct).attr("href",b).find("img").attr("src",b)});if(productPhotoDrop&&productPhotoCZoom){$(".left-product").on("click.mousetrap",".mousetrap",function(){var b=$(this).prev();$(this).data($.extend({frame:b.closest(genObj.parentBtnBuy),mainPhoto:b.attr("href"),title:b.attr("title")},optionsPhoto)).drop(optionsDrop).trigger("click.drop")})}}function initPhotoTrEv(){}$(document).on("scriptDefer",function(){initPhoto();cuselInit(body,"#variantSwitcher");tovarChangeVariant()});