var genObj={textEl:".text-el",emptyCarthideElement:"#popupCart .inside_padd table, #shopCartPage",emptyCartshowElement:"#popupCart .inside_padd div.msg, #shopCartPageEmpty",pM:".paymentMethod",trCartKit:"tr.cartKit",frameCount:".frame_count",countOrCompl:".countOrCompl",priceOrder:".priceOrder",minus:".minus",plus:".plus",parentBtnBuy:'li, [data-rel="frameP"]',wishListIn:"btn_cart",compareIn:"btn_cart",toWishlist:"toWishlist",inWishlist:"inWishlist",toCompare:"toCompare",inCompare:"inCompare",tinyBask:"tiny_bask",isAvail:"isAvail",loginButton:"#loginButton",inCart:"in_cart",notAvail:"not_avail",btnBuy:"btnBuy",btnBuyCss:"btn_buy",btnCartCss:"btn_cart",descr:".description",frameNumber:".frame_number",frameVName:".frame_variant_name",code:".code",prefV:".variant_",selVariant:".variant",imgVC:".vimg",imgVP:".vimg",priceVariant:".priceVariant",priceOrigVariant:"priceOrigVariant",photoProduct:".photoProduct"};var isTouch="ontouchstart" in document.documentElement;var optionsMenu={item:$(".menu-main td > .frame-item-menu > div"),duration:400,drop:"ul",itemSub:".frame-item-menu > ul > li",frameSub:".frame-item-menu > ul > li > div",effecton:"fadeIn",effectoff:"fadeOut"};var optionCompare={left:".leftDescription li",right:".comprasion_tovars_frame > li",elEven:"li",frameScroll:".comprasion_tovars_frame",mouseWhell:false,scrollNSP:true,scrollNSPT:".items_catalog",onlyDif:$('[data-href="#only-dif"]'),allParams:$('[data-href="#all-params"]'),hoverParent:".characteristic"};function navPortait(){var a=$(".frame-menu-main");headerMenu=$(".headerMenu");$(".headerMenu").each(function(){var e=$(this);if(e.hasClass("navHorizontal")){$(".frame-navbar").addClass("in");var d=$(".headerFon"),c=0,b=e.find("> li").outerHeight();if(e.hasClass("navVertical")){$(".btn-navbar").hide();e.removeClass("navVertical");$(".frame-navbar").addClass("in").show()}if(b<e.outerHeight()){$(".btn-navbar").show();$(".frame-navbar").removeClass("in");e.addClass("navVertical")}if($.exists_nabir(a)&&!a.children().hasClass("vertical")){c=a.offset().top+a.outerHeight(true);if($.exists(".frame_baner")){c=$(".frame_baner").height()/2+$(".frame_baner").offset().top}d.css({height:c,top:0})}else{d.css({height:$(".headerContent").outerHeight(true)+$("header").height(),top:0})}}})}function deleteComprasionItem(f){var h=f,g=h.parents("li"),b=h.parents("[data-equalhorizcell]").last(),c=b.find(optionCompare.right),e=c.add(b.siblings().find(optionCompare.right)).length,a=c.length;g.remove();if(a==1){var d=$('[data-href="#'+b.attr("id")+'"],[href="#'+b.attr("id")+'"]').parent();b.find(optionCompare.left).remove();if($.exists_nabir(d.next())){d.next().children().click()}else{d.prev().children().click()}d.remove()}if(e==1){$('[data-body="body"]').hide();$('[data-body="message"]').show()}$(".frame_tabsc > div").equalHorizCell("refresh")}function deleteWishListItem(a){if(a.parent().siblings().length==0){$('[data-body="body"]').hide();$('[data-body="message"]').show()}a.parent().remove()}def_min=$("span#opt1").data("def_min");def_max=$("span#opt2").data("def_max");cur_min=$("span#opt3").data("cur_min");cur_max=$("span#opt4").data("cur_max");function processWish(){var b=Shop.WishList.all();$("."+genObj.toWishlist).each(function(){if(b.indexOf($(this).data("prodid"))!==-1){var c=$(this);c.removeClass(genObj.toWishlist).addClass(genObj.inWishlist).addClass(genObj.wishListIn).attr("data-title",c.attr("data-sectitle")).find(genObj.textEl).text(c.attr("data-sectitle"))}});var a=Shop.CompareList.all();$("."+genObj.toCompare).each(function(){if(a.indexOf($(this).data("prodid"))!==-1){var c=$(this);c.removeClass(genObj.toCompare).addClass(genObj.inCompare).addClass(genObj.compareIn).attr("data-title",c.attr("data-sectitle")).find(genObj.textEl).text(c.attr("data-sectitle"))}})}function processPage(){Shop.Cart.totalRecount();$("#topCartCount").html(" ("+Shop.Cart.totalCount+")");if(!Shop.Cart.totalCount){$("."+genObj.tinyBask+"."+genObj.isAvail).removeClass(genObj.isAvail)}else{if(Shop.Cart.totalCount&&!$("."+genObj.tinyBask).hasClass(genObj.isAvail)){$("."+genObj.tinyBask).addClass(genObj.isAvail).on("click",function(){initShopPage()})}}var a=[];_.each(Shop.Cart.getAllItems(),function(b){a.push(b.id+"_"+b.vId)});$("."+genObj.btnBuy).each(function(){var b=$(this).data("prodid")+"_"+$(this).data("varid");if(a.indexOf(b)!=-1){$(this).removeClass(genObj.btnBuyCss).addClass(genObj.btnCartCss).removeAttr("disabled").html(inCart).unbind("click").on("click",function(){Shop.Cart.countChanged=false;togglePopupCart()}).closest(genObj.parentBtnBuy).addClass(genObj.inCart)}});$("."+genObj.btnBuy+"."+genObj.btnCartCss).each(function(){var b=$(this).data("prodid")+"_"+$(this).data("varid");if(a.indexOf(b)==-1){$(this).removeClass(genObj.btnCartCss).addClass(genObj.btnBuyCss).html(toCart).removeAttr("disabled").unbind("click").on("click",function(){Shop.Cart.countChanged=false;var c=Shop.composeCartItem($(this));Shop.Cart.add(c)}).closest(genObj.parentBtnBuy).removeClass(genObj.inCart)}})}function initShopPage(a){if(Shop.Cart.countChanged==false){Shop.Cart.totalRecount();$("#popupCart").html(Shop.Cart.renderPopupCart()).hide();$('[data-rel="plusminus"]').plusminus({prev:"prev.children(:eq(1))",next:"prev.children(:eq(0))"});function b(f){var d=f;var c=new Shop.cartItem({id:d.data("prodid"),vId:d.data("varid"),price:d.data("price"),kit:d.data("kit")});if(checkProdStock&&d.closest(genObj.frameCount).find("input").val()>=d.closest(genObj.frameCount).find("input").data("max")){d.closest(genObj.frameCount).find("input").val(d.closest(genObj.frameCount).find("input").data("max"));d.closest(genObj.frameCount).tooltip()}c.count=d.closest(genObj.frameCount).find("input").val();var e=c.kit?kits:pcs;d.closest("tr").find(genObj.countOrCompl).html(e);Shop.Cart.chCount(c,function(){});$("#topCartCount").html(" ("+Shop.Cart.totalCount+")");totalPrice=c.count*c.price;d.closest("tr").find(genObj.priceOrder).html(totalPrice.toFixed(pricePrecision));$("#popupCartTotal").html(Shop.Cart.totalPrice.toFixed(pricePrecision));if(d.closest(genObj.frameCount).find("input").val()==1){d.closest(genObj.frameCount).find(genObj.minus).attr("disabled","disabled")}else{d.closest(genObj.frameCount).find(genObj.minus).removeAttr("disabled")}}$(genObj.frameCount+" "+genObj.minus+", "+genObj.frameCount+" "+genObj.plus).die("click").live("click",function(){b($(this).closest("div"))});$(genObj.frameCount+"input").die("keyup").live("keyup",function(){b($(this).prev("div"))});if(typeof a=="undefined"||a!=false){$("#showCart").click()}}}function rmFromPopupCart(c,b){if(typeof b!="undefined"&&b==true){var d=$(c).closest(genObj.trCartKit)}else{var d=$(c).closest("tr")}var a=new Shop.cartItem();a.id=d.data("prodid");a.vId=d.data("varid");Shop.Cart.rm(a).totalRecount()}function togglePopupCart(){$("#showCart").click();return false}function renderOrderDetails(){$("#orderDetails").html(_.template($("#orderDetailsTemplate").html(),{cart:Shop.Cart}))}function changeDeliveryMethod(a){$.get("/shop/cart_api/getPaymentsMethods/"+a,function(b){data=JSON.parse(b);var c=_.template('<select id="paymentMethod" name="paymentMethodId"><% _.each(data, function(item) { %><option value="<%-item.id%>"><%-item.name%></option> <% }) %></select> ',{data:data});$(genObj.pM).html(c);cuSel({changedEl:"#paymentMethod"})})}function recountCartPage(){var a=$("span.cuselActive");Shop.Cart.shipping=parseFloat(a.data("price"));Shop.Cart.shipFreeFrom=parseFloat(a.data("freefrom"));delete a;$("span#totalPrice").html(parseFloat(Shop.Cart.getTotalPrice()).toFixed(pricePrecision));$("span#finalAmount").html(parseFloat(Shop.Cart.getFinalAmount()).toFixed(pricePrecision));$("span#shipping").html(parseFloat(Shop.Cart.shipping).toFixed(pricePrecision));$("span.curr").html(curr)}function emptyPopupCart(){$(genObj.emptyCarthideElement).hide();$(genObj.emptyCartshowElement).removeClass("d_n").show()}function checkCompareWishLink(){var d=$("#wishListData"),c=$("#compareListData"),a='[data-rel="ref"]',b='[data-rel="notref"]';if(Shop.WishList.all().length){d.find(a).removeClass("d_n").find("a").removeClass("d_n");d.find(b).addClass("d_n")}else{d.find(a).addClass("d_n").find("a").addClass("d_n");d.find(b).removeClass("d_n")}if(Shop.CompareList.all().length){c.find(a).removeClass("d_n").find("a").removeClass("d_n");c.find(b).addClass("d_n")}else{c.find(a).addClass("d_n").find("a").addClass("d_n");c.find(b).removeClass("d_n")}}function checkSyncs(){if(inServerCompare!=NaN){if(Shop.CompareList.all().length!=inServerCompare){Shop.CompareList.sync()}}if(inServerWish!=NaN){if(Shop.WishList.all().length!=inServerWish){Shop.WishList.sync()}}if(inServerCart!=NaN){if(Shop.Cart.getAllItems().length!=inServerCart){Shop.Cart.sync()}}}$(document).ready(function(){$('.formCost input[type="text"], .number input').live("keypress",function(h){var f,g;if(!h){var h=window.event}if(h.keyCode){f=h.keyCode}else{if(h.which){f=h.which}}if(f==null||f==0||f==8||f==13||f==9||f==46||f==37||f==39){return true}g=String.fromCharCode(f);if(!/\d/.test(g)){$(this).tooltip();return false}else{$(this).tooltip("remove")}});if(ltie7){ieInput()}$("#slider").sliderInit({minCost:$("#minCost"),maxCost:$("#maxCost")});if($.exists(".lineForm")){var e={changedEl:".lineForm select",visRows:100,scrollArrows:true};cuSel(e)}$(".menu-main").menuPacket2(optionsMenu);$(".drop").drop({overlayColor:"#000",overlayOpacity:"0.6",before:function(i,j){if($(j).hasClass("drop-report")){$(j).removeClass("left-report").removeClass("top-right-report");if($(i).offset().left<322-$(i).outerWidth()){$(i).attr("data-placement","bottom left");$(j).addClass("left-report")}else{if($(i).data("placement")!="top right"){$(i).attr("data-placement","bottom right")}}if($(i).data("placement")=="top right"){$(j).addClass("top-right-report")}$(j).find(genObj.parentBtnBuy).remove();var g=$(i).closest(genObj.parentBtnBuy).clone().removeAttr("style").removeAttr("class"),j=$(j).find(".drop-content");var f=$("#data-report");var h=$(i).attr("data-prodid");f.find('input[name="ProductId"]').val(h);g.find(".photo").prependTo(g);$(".icon-times-enter").live("click",function(){j.parent().fadeOut(300);$(".overlayDrop").fadeOut(100)});if(!j.parent().hasClass("active")){if(!$.exists_nabir(j.find(".frame-search-thumbail"))){j.append('<ul class="frame-search-thumbail items"></ul>')}j.find(".frame-search-thumbail").append(g).find(".top_tovar, .btn, .frame_response, .tabs, .share_tov, .frame_tabs, .variantProd").remove().end().parent().find('[data-clone="data-report"]').remove().end().append($('[data-clone="data-report"]').clone().removeClass("d_n"))}return $(i)}},after:function(f,g){}});$(".tabs").tabs({after:function(f){if(f.parent().hasClass("comprasion_head")){$(".frame_tabsc > div").equalHorizCell(optionCompare);if(optionCompare.onlyDif.parent().hasClass("active")){optionCompare.onlyDif.click()}else{optionCompare.allParams.click()}}}});$(".frame_tabsc > div").equalHorizCell(optionCompare);$('[data-rel="plusminus"]').plusminus({prev:"prev.children(:eq(1))",next:"prev.children(:eq(0))"});try{$('a[rel="group"]').fancybox({padding:45,margin:0,overlayOpacity:0.7,overlayColor:"#212024",scrolling:"no"})}catch(d){}processPage();checkSyncs();processWish();recountCartPage();if(window.location.href.match(/cart/)){changeDeliveryMethod($("#method_deliv").val())}$("#popupCart").html(Shop.Cart.renderPopupCart());$("."+genObj.btnBuyCss).not(".psPay").on("click",function(){Shop.Cart.countChanged=false;$(this).attr("disabled","disabled");var f=Shop.composeCartItem($(this));Shop.Cart.add(f);return true});if($("#orderDetails")){renderOrderDetails()}initShopPage(false);if($("#method_deliv")){$("#method_deliv").on("change",function(){recountCartPage();changeDeliveryMethod($("span.cuselActive").attr("val"))})}if($("#orderDetails")){renderOrderDetails()}if($("#method_deliv")){$("#method_deliv").on("change",function(){recountCartPage()})}$("#topCartCount").html(" ("+Shop.Cart.totalCount+")");$("."+genObj.tinyBask+"."+genObj.isAvail).on("click",function(){initShopPage()});checkCompareWishLink();$(document).live("cart_changed",function(){processPage();renderOrderDetails();if($("#method_deliv")){recountCartPage()}$("#popupCartTotal").html(Shop.Cart.totalPrice.toFixed(pricePrecision));if(Shop.Cart.totalCount==0){emptyPopupCart()}});$(document).on("after_add_to_cart",function(f){initShopPage();Shop.Cart.countChanged=false});$(document).on("cart_rm",function(f){if(!f.cartItem.kit){$("#popupProduct_"+f.cartItem.id+"_"+f.cartItem.vId).remove()}else{$("#popupKit_"+f.cartItem.kitId).remove()}});$("."+genObj.toCompare).on("click",function(){var f=$(this).data("prodid");Shop.CompareList.add(f)});$("."+genObj.toWishlist).on("click",function(){var g=$(this).data("prodid");var f=$(this).data("varid");Shop.WishList.add(g,f)});$("."+genObj.inWishlist).die("click").live("click",function(){document.location.href="/shop/wish_list"});$("."+genObj.inCompare).die("click").live("click",function(){document.location.href="/shop/compare"});$(document).on("wish_list_add",function(g){if(g.dataObj.success==true){$("#wishListCount").html("("+Shop.WishList.all().length+")");var f=$("."+genObj.toWishlist+"[data-prodid="+g.dataObj.id+"]");f.removeClass(genObj.toWishlist).addClass(genObj.inWishlist).addClass(genObj.wishListIn).attr("data-title",f.attr("data-sectitle")).find(genObj.textEl).text(f.attr("data-sectitle"));f.tooltip()}checkCompareWishLink();f.tooltip()});$(document).on("compare_list_add",function(g){if(g.dataObj.success==true){$("#compareListCount").html("("+Shop.WishList.all().length+")");var f=$("."+genObj.toCompare+"[data-prodid="+g.dataObj.id+"]");f.removeClass(genObj.toCompare).addClass(genObj.inCompare).addClass(genObj.wishListIn).attr("data-title",f.attr("data-sectitle")).find(genObj.textEl).text(f.attr("data-sectitle"));f.tooltip()}$("#compareCount").html("("+Shop.CompareList.all().length+")");checkCompareWishLink();f.tooltip()});$(document).on("compare_list_add wish_list_rm compare_list_rm compare_list_sync",function(){checkCompareWishLink()});$(document).on("wish_list_sync compare_list_sync",function(){processWish()});$(document).on("compare_list_rm compare_list_sync",function(){$("#compareCount").html("("+Shop.CompareList.all().length+")")});$(document).on("wish_list_rm wish_list_sync",function(){$("#wishListCount").html("("+Shop.WishList.all().length+")")});$("#applyGiftCert").on("click",function(){$("input[name=makeOrder]").val(0);$("input[name=checkCert]").val(1);$("#makeOrderForm").ajaxSubmit({url:"/shop/cart_api/getGiftCert",success:function(g){try{var f=JSON.parse(g);Shop.Cart.giftCertPrice=f.cert_price;if(Shop.Cart.giftCertPrice>0){$("#giftCertPrice").html(parseFloat(Shop.Cart.giftCertPrice).toFixed(pricePrecision)+" "+curr);$("#giftCertSpan").show()}Shop.Cart.totalRecount();recountCartPage()}catch(h){}}});$("input[name=makeOrder]").val(1);return false});function c(f,h){if($.trim(f)!=""){var g=h.find(genObj.frameNumber).show();g.find(genObj.code).html("("+f+")")}else{var g=h.find(genObj.frameNumber).show();g.find(genObj.code).html(" ")}}function b(g,h){if($.trim(g)!=""){var f=h.find(genObj.frameVName).show();f.find(genObj.code).html("("+g+")")}else{var f=h.find(genObj.frameVName).hide();f.find(genObj.code).html(" ")}}function a(h,g,f){g.removeClass(genObj.notAvail).removeClass(genObj.inCart);if(h==0){g.addClass(genObj.notAvail)}if(f.hasClass(genObj.btnCartCss)){g.addClass(genObj.inCart)}}$("#variantSwitcher").live("change",function(){var j=$(this).attr("value"),f=$(this).closest(genObj.parentBtnBuy);var o=$(genObj.prefV+j).attr("data-id"),h=$(genObj.prefV+j).attr("data-vname"),l=$(genObj.prefV+j).attr("data-price"),g=$(genObj.prefV+j).attr("data-origPrice"),k=$(genObj.prefV+j).attr("data-number"),n=$(genObj.prefV+j).attr("data-largeImage"),i=$(genObj.prefV+j).attr("data-mainImage"),m=$(genObj.prefV+j).attr("data-stock");$(genObj.photoProduct).attr("href",n);$(genObj.imgVP).attr("src",i).attr("alt",h);f.find(genObj.priceOrigVariant).html(g);f.find(genObj.priceVariant).html(l);c(k,f);b(h,f);a(m,f,f.find(genObj.prefV+j+"."+genObj.btnBuy));f.find(genObj.selVariant).hide();f.find(genObj.prefV+o).show()});$("[id ^= сVariantSwitcher_]").live("change",function(){var j=$(this).attr("value"),f=$(this).closest(genObj.parentBtnBuy);var i=f.find(genObj.prefV+j).attr("data-mediumImage"),n=$(genObj.prefV+j).attr("data-id"),h=f.find(genObj.prefV+j).attr("data-vname"),l=f.find(genObj.prefV+j).attr("data-price"),g=f.find(genObj.prefV+j).attr("data-origPrice"),k=f.find(genObj.prefV+j).attr("data-number"),m=f.find(genObj.prefV+j).attr("data-stock");f.find(genObj.selVariant).hide();f.find(genObj.prefV+n).show();f.find(genObj.priceOrigVariant).html(g);f.find(genObj.priceVariant).html(l);f.find(genObj.imgVC).attr("src",i).attr("alt",h);c(k,f);b(h,f);a(m,f,f.find(genObj.prefV+n+"."+genObj.btnBuy))})});wnd.load(function(){if($(".cycle li").length>1){$(".cycle").cycle({speed:600,timeout:2000,fx:"fade",pager:".cycle .nav",pagerEvent:"click",pauseOnPagerHover:true,next:".frame_baner .next",prev:".frame_baner .prev",pager:".pager",pagerAnchorBuilder:function(f,e){return'<a href="#"></a>'}}).hover(function(){$(".cycle").cycle("pause")},function(){$(".cycle").cycle("resume")})}$(".carousel_js:not(.vertical_carousel)").myCarousel({item:"li",prev:".btn_prev",next:".btn_next",content:".carousel",before:function(){var f=0;var e=$(".frame_brand img");if($.exists_nabir(e.closest(".carousel_js"))){e.each(function(){var g=$(this).height();if(g>f){f=g}});$(".frame_brand .helper").css("height",f)}}});wnd.resize(function(){navPortait();$(".frame_tabsc > div").equalHorizCell("refresh");$(".menu-main").menuPacket2("refresh");var e=$(".btn_not_avail.active");if(e.length!=0){e.drop("positionDrop")}});navPortait();var b=$("[data-radio-frame]");$(".list_pic_btn > .btn").click(function(){var e=$(this);if(e.hasClass("showAsList")){b.addClass("list");setcookie("listtable",e.index(),1,"/")}else{b.removeClass("list");setcookie("listtable",e.index(),0,"/")}e.siblings().removeClass("active").end().addClass("active")});var a=$(".item_tovar .frame_thumbs > li");if($.exists_nabir(a)){a.click(function(){var e=$(this);e.addClass("active").siblings().removeClass("active")});$(".fancybox-next").live("click",function(){$this=a.filter(".active");if(!$this.is(":last-child")){$this.removeClass("active").next().addClass("active")}else{a.first().click()}});$(".fancybox-prev").live("click",function(){$this=a.filter(".active");if(!$this.is(":first-child")){$this.removeClass("active").prev().addClass("active")}else{a.last().click()}})}var d=$(".frameLabel").length;$(".frameLabel").each(function(e){$(this).css({position:"relative","z-index":d-e})});$("#suggestions").autocomlete();$(".btn-navbar").click(function(){var e=$(".frame-navbar");if(!e.hasClass("in")){e.addClass("in").show()}else{e.removeClass("in").hide()}});$(".frame_tabsc > div").equalHorizCell("refresh");try{$("a.fancybox").fancybox()}catch(c){}});