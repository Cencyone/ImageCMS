var productPhotoCZoom=window.productPhotoCZoom!=undefined,productPhotoDrop=window.productPhotoDrop!=undefined;function tovarChangeVariant(a){a=a==undefined?body:a;a.find("#variantSwitcher").on("change",function(){var g=parseInt($(this).attr("value")),b=$(this).closest(genObj.parentBtnBuy),m=b.find(genObj.prefV+g+" "+genObj.infoBut),n=m.attr("data-id"),e=m.attr("data-vname"),h=m.attr("data-number"),i=m.attr("data-price"),j=m.attr("data-addPrice"),d=m.attr("data-origPrice"),l=m.attr("data-largeImage"),f=m.attr("data-mainImage"),k=m.attr("data-maxcount");if(f.search(/nophoto/)==-1){$(genObj.photoProduct).attr("href",l);$(genObj.imgVP).attr("src",f).attr("alt",e)}if(d!=""){b.find(genObj.priceOrigVariant).html(d)}b.find(genObj.priceVariant).html(i);b.find(genObj.priceAddPrice).html(j);existsVnumber(h,b);existsVnames(e,b);condProduct(k,b,b.find(genObj.prefV+g+" "+genObj.infoBut));b.find(genObj.selVariant).hide();b.find(genObj.prefV+n).show();if(productPhotoDrop){console.log(1);var c=$(genObj.photoProduct);c.data($.extend({frame:c.closest(genObj.parentBtnBuy),mainPhoto:c.attr("href"),title:c.attr("title")},optionsPhoto)).drop(optionsDrop)}})}function resizePhoto(b,d,h){var f=$(hrefOptions.placeHref).parent();f.css("height","");var e=b.is(":visible")?true:false;hD=e?b.height():b.actual("height");var g=hD>wnd.height()?wnd.height():hD,a=0;if(d!=undefined){d()}$(hrefOptions.header).add($(hrefOptions.footer)).add($(hrefOptions.gallery)).each(function(){a+=e?$(this).outerHeight():$(this).actual("outerHeight")});$(hrefOptions.header).add($(hrefOptions.footer)).add($(hrefOptions.gallery));mayHC=g-a;f.css({height:mayHC-(f.outerHeight()-f.height())});if(h!=undefined){h()}$.drop("dropCenter")(b)}function changePhoto(a,b,d){hrefOptions.curHref=d;var c=a[1];b.parent().addClass("p_r");b.after('<div class="preloader"></div>');$('<img src="'+d+'">').load(function(){$(hrefOptions.placeHref).find("img").remove();b.nextAll(".preloader").remove();b.after($(this).css("visibility","visible").hide().fadeIn());var e=c.find(".content-carousel");$.drop("limitSize")(c);resizePhoto(c,function(){e.parent().myCarousel($.extend({},carousel,{adding:{start:$.inArray(hrefOptions.curHref,hrefOptions.thumbs)}}));$.drop("dropCenter")(c)})})}function beforeShowHref(a,f,e,u,c){var d=arguments,h=hrefOptions.cycle;var i=$.extend({},c,hrefOptions,a.closest(genObj.parentBtnBuy).find(genObj.infoBut).data());frame=$("#photo");frame.html(_.template($("#photoProduct").html(),i));tovarChangeCount(frame);btnbuyInitialize(frame);processBtnBuyCount(frame);var m=$(hrefOptions.next),k=$(hrefOptions.prev),v=$(hrefOptions.placeHref).find("img");hrefOptions.curHref=v.attr("src");var o=$(hrefOptions.placeHref).find(".helper");function b(w){if(!h){if(w==0){k.attr("disabled","disabled")}if(w==r-1){m.attr("disabled","disabled")}}}function g(w){j.removeClass("active");if(w.is(k)){m.removeAttr("disabled")}else{k.removeAttr("disabled")}t=($.inArray(hrefOptions.curHref,hrefOptions.thumbs));if(w.is(k)){if(h){if(t!=0){t=t-1}else{t=r-1}}else{if(t!=0){t=t-1}if(t==0){k.attr("disabled","disabled")}}}else{if(h){if(t!=r-1){t=t+1}else{t=0}}else{if(t!=r-1){t=t+1}if(t==r-1){m.attr("disabled","disabled")}}}l.eq(t).parent().addClass("active");changePhoto(d,o,hrefOptions.thumbs[t])}var p=f.find(".content-carousel");if($.existsN(p.find(".items-thumbs").children())){p.closest(".horizontal-carousel").show();var j=p.find(".items-thumbs > li").removeClass("active"),r=j.length,l=j.find("a");hrefOptions.thumbs=new Array();l.each(function(){hrefOptions.thumbs.push($(this).attr("href"))});var n=k.add(m).removeAttr("disabled").fadeIn(),t=($.inArray(hrefOptions.curHref,hrefOptions.thumbs)),s=t<r?t:t-r;if(s>=0){j.eq(s).addClass("active")}else{j.last().after(j.last().clone()).next().addClass("active addingphoto").find("a").attr("href",hrefOptions.curHref).find("img").attr("src",hrefOptions.curHref)}var j=p.find(".items-thumbs > li"),r=j.length,l=j.find("a");hrefOptions.thumbs.length=0;l.each(function(){hrefOptions.thumbs.push($(this).attr("href"))});t=($.inArray(v.attr("src"),hrefOptions.thumbs));var q=j.parent();if($.existsN(q.parent(".jcarousel-clip"))){q.unwrap()}l.off("click").on("click",function(y){n.removeAttr("disabled");j.removeClass("active");$(this).parent().addClass("active");var w=$(this).attr("href"),x=($.inArray(w,hrefOptions.thumbs));y.preventDefault();changePhoto(d,o,w);b(x)});n.off("click").on("click",function(w){g($(this))});b(t)}else{p.closest(".horizontal-carousel").hide()}wnd.unbind("resize.photo").bind("resize.photo",function(){resizePhoto(f)})}function afterClosedPhoto(b,a){a.find(".addingphoto").remove()}function onComplete(d,c,a,e,b){var f=c.find(".content-carousel");c.find(".drop-content-photo img").css("visibility","visible").hide().fadeIn();$.drop("limitSize")(c);resizePhoto(c,function(){f.parent().myCarousel($.extend({},carousel,{adding:{start:$.inArray(hrefOptions.curHref,hrefOptions.thumbs)},after:function(g){g.find("ul").css("visibility","visible")}}))})}var hrefOptions={next:"#photo .drop-content-photo .next",prev:"#photo .drop-content-photo .prev",placeHref:"#photo .drop-content-photo .inside-padd",header:"#photo .drop-header",footer:"#photo .drop-footer",gallery:"#photo .frame-fancy-gallery",cycle:false,footerContent:".frame-prices-buy",galleryContent:".items-thumbs"};var optionsPhoto={effectOn:"fadeIn",drop:"#photo",size:false,callback:"onComplete",beforeShowHref:"beforeShowHref",elClosed:"afterClosedPhoto"};function initPhoto(){if(productPhotoCZoom){function a(){$(genObj.photoProduct).find("img").each(function(){var d=$(this),c=Math.ceil((d.parent().outerHeight()-d.height())/2),e=Math.ceil((d.parent().outerWidth()-d.width())/2);$("#forCloudZomm").empty().append(".cloud-zoom-lens{margin:"+c+"px 0 0 "+e+"px;}.mousetrap{top:"+c+"px !important;left:"+e+"px !important;}")});$(".left-product").off("mouseover",".mousetrap").on("mouseover",".mousetrap",function(){var c=$(".cloud-zoom-lens");if(c.width()>$(genObj.photoProduct).width()){$(this).remove();c.remove();$("#xBlock").empty()}})}}if(productPhotoCZoom){$(".cloud-zoom, .cloud-zoom-gallery").CloudZoom();body.append('<style id="forCloudZomm"></style>');a();$(genObj.photoProduct).find("img").load(function(){a()})}$(".item-product .items-thumbs > li > a").on("click.thumb",function(d){d.preventDefault();var c=$(this);c.parent().siblings().removeClass("active").end().addClass("active");hrefOptions.curHref=c.parent().index();$(hrefOptions.placeHref).find("img").attr("src",c.attr("href"));$(hrefOptions.gallery).find("li").removeClass("active").filter(":eq("+hrefOptions.curHref+")").addClass("active")});if((!productPhotoCZoom&&!productPhotoDrop)||productPhotoDrop){$(".item-product .items-thumbs > li > a").on("click.thumb",function(f){f.preventDefault();var d=$(this);$(genObj.photoProduct).attr("href",d.attr("href")).find("img").attr("src",d.attr("href")).end().click(function(g){g.preventDefault()});if(productPhotoDrop){var c=$(genObj.photoProduct);c.data($.extend({frame:c.closest(genObj.parentBtnBuy),mainPhoto:c.attr("href"),title:c.attr("title")},optionsPhoto)).drop(optionsDrop)}})}if(productPhotoDrop){var b=$(genObj.photoProduct);b.data($.extend({frame:b.closest(genObj.parentBtnBuy),mainPhoto:b.attr("href"),title:b.attr("title")},optionsPhoto)).drop(optionsDrop)}if(productPhotoDrop&&productPhotoCZoom){$(".left-product").on("click.mousetrap",".mousetrap",function(){var d=$(this),c=d.prev();d.data($.extend({frame:c.closest(genObj.parentBtnBuy),mainPhoto:c.attr("href"),title:c.attr("title")},optionsPhoto)).drop(optionsDrop).trigger("click.drop")})}}function initPhotoTrEv(){}$(document).on("scriptDefer",function(){initPhoto();cuselInit(body,"#variantSwitcher");tovarChangeVariant()});